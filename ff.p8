pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
gstate = {}
px = 64
py = 64

function print_debug()
 cursor(4, 4)
 color(7)
 print("coor: " .. px .. ", " .. py)
 print("tile: " .. ((px - (px%8)) / 8) .. ", " .. ((py - (py%8)) / 8))
 print("solid:" .. (is_solid(px, py) and "yes" or "nope"))
end

function is_solid(x, y)
 local tilex = ((x - (x%8)) / 8)
 local tiley = ((y - (y%8)) / 8)
 local tile_index = mget(tilex, tiley)
 return fget(tile_index, 0) 
end

function draw_background()
 rectfill(0, 0, 128, 128, 3)
 map(0, 0, 0, 0) 
end

function button_collision_check(button, xoff, yoff)
 if btn(button) then 
  if not is_solid(px + xoff, py + yoff) then
	  px += xvel
	  py += yvel
	 end
 end
end

function game_update()
 button_collision_check(0, -1,  0, -1,  0)
 button_collision_check(1,  8,  0,  1,  0)
 button_collision_check(2,  0, -1,  0, -1)
 button_collision_check(3,  0,  8,  0,  1)
end

function game_draw()
 draw_background()
 spr(1, px, py)
 print_debug()
end

function _init()
 gstate.update = game_update
 gstate.draw = game_draw
end

function _update()
 gstate.update()
end

function _draw()
 gstate.draw()
end

__gfx__
0000000006000060000000000000000000f00f0f4444454400000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000006066060000000000000000000f0ff0f4444454400000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070065666656000880000000000000ff44ff4444454400000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000665665660088880000000000004044045555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000666666660b8888b000000000000444404454444400000000000000000000000000000000000000000000000000000000000000000000000000000000
007007000666666000b88b0000000000044455404454444400000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000006666000b0bb0b0004444444444f5404454444400000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000004444f44f4f444005555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000333333b3444f44f4444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000b33b333344f44444f44440000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000333333b344444f44444400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000003b33b33304444444004400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000033b3333300400044004400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000033333b3300400044004400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000003b3b33b304400040004400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000003333333304400040000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0505050505050505050505050505050500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0500000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0500000002000000000002000000000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0500000000000002000000000000000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0500020000000000000000000000000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0500000000020012121212120000000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0500000000000012121212120000000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0500000000000012121212120000000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0500000200000012121212120000000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0500000000000012121212120000000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0500000002000000000000000000000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0500000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0500000000000000000002000000000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0500000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0500000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050505050505050505050500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
